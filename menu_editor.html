<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOSBETA Menu Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .editor-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .category-section { border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 16px; padding: 16px; }
        .item-row { display: flex; gap: 12px; align-items: center; margin-bottom: 8px; padding: 8px; background: #f9fafb; border-radius: 4px; }
        .item-input { flex: 1; padding: 6px; border: 1px solid #d1d5db; border-radius: 4px; }
        .btn { padding: 6px 12px; border-radius: 4px; border: none; cursor: pointer; font-size: 14px; }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-success { background: #10b981; color: white; }
        .color-badge { padding: 2px 8px; border-radius: 12px; font-size: 12px; color: white; }
        .purple { background: #8e44ad; }
        .blue { background: #3498db; }
        .green { background: #27ae60; }
        .orange { background: #e67e22; }
        .red { background: #e74c3c; }
        .black { background: #34495e; }
        .output-section { background: #f3f4f6; padding: 16px; border-radius: 8px; margin-top: 20px; }
        .code-output { background: #1f2937; color: #f3f4f6; padding: 16px; border-radius: 4px; font-family: monospace; font-size: 12px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="editor-container">
        <h1 class="text-3xl font-bold mb-6">NOSBETA Menu Editor</h1>
        
        <div class="mb-6">
            <label class="block text-sm font-medium mb-2">Base URL:</label>
            <input type="text" id="baseUrl" class="w-full p-2 border border-gray-300 rounded" 
                   value="https://experience.arcgis.com/experience/ce0b7dc7574c49a8a82f36443fee494f/page/">
        </div>

        <div id="categoriesContainer"></div>
        
        <div class="mb-6">
            <button onclick="addCategory()" class="btn btn-primary">Add New Category</button>
            <button onclick="generateCode()" class="btn btn-success ml-2">Generate HTML Code</button>
            <button onclick="saveConfig()" class="btn btn-primary ml-2">Save Configuration</button>
            <button onclick="loadConfig()" class="btn btn-primary ml-2">Load Configuration</button>
        </div>

        <div class="output-section">
            <h3 class="text-lg font-semibold mb-4">Generated HTML:</h3>
            <div id="htmlOutput" class="code-output"></div>
        </div>
    </div>

    <script>
        let categories = [
            {
                id: 'sit-summary',
                title: '1 Situation Summary',
                color: 'purple',
                items: [
                    { title: 'National', url: 'National', searchTerms: 'National' },
                    { title: 'Heat Risk', url: 'Heat-Risk', searchTerms: 'Heat Risk' }
                ]
            },
            {
                id: 'weather',
                title: '2 Weather',
                color: 'blue',
                items: [
                    { title: 'Storm Prediction Center', url: 'Storm-Prediction-Center', searchTerms: 'Storm Prediction Center' }
                ]
            }
        ];

        function renderCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            categories.forEach((category, categoryIndex) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-section';
                
                categoryDiv.innerHTML = `
                    <div class="flex items-center gap-4 mb-4">
                        <input type="text" value="${category.title}" 
                               onchange="updateCategory(${categoryIndex}, 'title', this.value)"
                               class="text-lg font-semibold p-2 border rounded flex-1">
                        <select onchange="updateCategory(${categoryIndex}, 'color', this.value)"
                                class="p-2 border rounded">
                            <option value="purple" ${category.color === 'purple' ? 'selected' : ''}>Purple</option>
                            <option value="blue" ${category.color === 'blue' ? 'selected' : ''}>Blue</option>
                            <option value="green" ${category.color === 'green' ? 'selected' : ''}>Green</option>
                            <option value="orange" ${category.color === 'orange' ? 'selected' : ''}>Orange</option>
                            <option value="red" ${category.color === 'red' ? 'selected' : ''}>Red</option>
                            <option value="black" ${category.color === 'black' ? 'selected' : ''}>Black</option>
                        </select>
                        <span class="color-badge ${category.color}">${category.color}</span>
                        <button onclick="deleteCategory(${categoryIndex})" class="btn btn-danger">Delete Category</button>
                    </div>
                    <div id="items-${categoryIndex}"></div>
                    <button onclick="addItem(${categoryIndex})" class="btn btn-primary mt-2">Add Item</button>
                `;
                
                container.appendChild(categoryDiv);
                renderItems(categoryIndex);
            });
        }

        function renderItems(categoryIndex) {
            const container = document.getElementById(`items-${categoryIndex}`);
            const category = categories[categoryIndex];
            
            container.innerHTML = '';
            
            category.items.forEach((item, itemIndex) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item-row';
                
                itemDiv.innerHTML = `
                    <input type="text" value="${item.title}" 
                           onchange="updateItem(${categoryIndex}, ${itemIndex}, 'title', this.value)"
                           class="item-input" placeholder="Button Title">
                    <input type="text" value="${item.url}" 
                           onchange="updateItem(${categoryIndex}, ${itemIndex}, 'url', this.value)"
                           class="item-input" placeholder="URL Endpoint">
                    <input type="text" value="${item.searchTerms}" 
                           onchange="updateItem(${categoryIndex}, ${itemIndex}, 'searchTerms', this.value)"
                           class="item-input" placeholder="Search Terms">
                    <button onclick="deleteItem(${categoryIndex}, ${itemIndex})" class="btn btn-danger">Delete</button>
                `;
                
                container.appendChild(itemDiv);
            });
        }

        function addCategory() {
            categories.push({
                id: `category-${Date.now()}`,
                title: 'New Category',
                color: 'blue',
                items: []
            });
            renderCategories();
        }

        function deleteCategory(index) {
            if (confirm('Are you sure you want to delete this category?')) {
                categories.splice(index, 1);
                renderCategories();
            }
        }

        function addItem(categoryIndex) {
            categories[categoryIndex].items.push({
                title: 'New Item',
                url: 'new-item',
                searchTerms: 'New Item'
            });
            renderItems(categoryIndex);
        }

        function deleteItem(categoryIndex, itemIndex) {
            categories[categoryIndex].items.splice(itemIndex, 1);
            renderItems(categoryIndex);
        }

        function updateCategory(index, field, value) {
            categories[index][field] = value;
        }

        function updateItem(categoryIndex, itemIndex, field, value) {
            categories[categoryIndex].items[itemIndex][field] = value;
        }

        function generateCode() {
            const baseUrl = document.getElementById('baseUrl').value;
            let html = '';
            
            categories.forEach((category, index) => {
                html += `
                <!-- Category: ${category.title} -->
                <div class="category-card card-${index + 1}-${category.id}">
                    <h2 class="category-title">${category.title}</h2>`;
                
                category.items.forEach(item => {
                    html += `
                    <a href="${baseUrl}${item.url}" class="menu-button btn-${category.color}" data-search-term="${item.searchTerms}">${item.title}</a>`;
                });
                
                html += `
                </div>`;
            });
            
            document.getElementById('htmlOutput').textContent = html;
        }

        function saveConfig() {
            const config = {
                baseUrl: document.getElementById('baseUrl').value,
                categories: categories
            };
            
            const dataStr = JSON.stringify(config, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'nosbeta-menu-config.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        function loadConfig() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const config = JSON.parse(e.target.result);
                            document.getElementById('baseUrl').value = config.baseUrl || '';
                            categories = config.categories || [];
                            renderCategories();
                        } catch (error) {
                            alert('Error loading configuration: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // Initialize
        renderCategories();
    </script>
</body>
</html>